<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Daniel P. Quinn</title><meta name="next-head-count" content="3"/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a54b4f32bdc1ef890ddd.js"></script><script src="/_next/static/chunks/webpack-61f1b6d34e7ba415b8c1.js" defer=""></script><script src="/_next/static/chunks/framework-895f067827ebe11ffe45.js" defer=""></script><script src="/_next/static/chunks/main-b9780dc6f4fa7abb3771.js" defer=""></script><script src="/_next/static/chunks/pages/_app-76f68770679821db743d.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-ed8a1c1d247a5bbba654.js" defer=""></script><script src="/_next/static/OJKJPB7h_rkE15QK9wh6b/_buildManifest.js" defer=""></script><script src="/_next/static/OJKJPB7h_rkE15QK9wh6b/_ssgManifest.js" defer=""></script></head><body><div id="__next"><h1><a href="/">Daniel P. Quinn</a></h1><article><time datetime="2021-08-14">2021-08-14</time><h2>Code Sketch - Perlin Circles</h2><br/><div><video autoplay loop controls>
  <source src="/assets/2021-08/perlin-circles.mp4" type="video/mp4">
</video>
<p><a href="https://nannou.cc/">Nannou</a> code:</p>
<pre><code>use nannou::noise::*;
use nannou::prelude::*;

fn main() {
    nannou::app(model).run();
}

struct Model {
    cols: u32,
    rows: u32,
    noise: Perlin,
}

fn model(app: &#x26;App) -> Model {
    let width = 200;
    let height = 200;
    let scale = 10;
    app.new_window().size(width, height).view(view).build().unwrap();
    let cols = width / scale;
    let rows = height / scale;
    let mut noise = Perlin::new();
    noise = noise.set_seed(1);

    Model {
        cols,
        rows,
        noise
    }
}

fn view(app: &#x26;App, model: &#x26;Model, frame: Frame) {
    frame.clear(BLACK);
    let win = app.main_window();
    let win_r = win.rect();

    let draw = app.draw();
    let mut yoff = 0.0;
    let zoff = app.time / 5.0;
    let cell_size = (win_r.right() - win_r.left()) / model.cols as f32;

    for col in 0..model.cols {
        let mut xoff = 0.0;
        for row in 0..model.rows {
            let random = model.noise.get([xoff as f64, yoff as f64, zoff as f64]);
            let start_x = map_range(col as f32, 0.0, model.cols as f32, win_r.left(), win_r.right());
            let start_y = map_range(row as f32, 0.0, model.rows as f32, win_r.bottom(), win_r.top());
            let size = random as f32 * cell_size;

            draw.ellipse()
                .width(size)
                .height(size)
                .x_y(start_x, start_y)
                .color(hsl(random as f32, 1.0, 0.5));

                xoff += 0.1;
        }

        yoff += 0.1;
    }

    draw.to_frame(app, &#x26;frame).unwrap();
    
    if frame.nth() &#x3C; 300 {
        let file_path = captured_frame_path(app, &#x26;frame);
        app.main_window().capture_frame(file_path);
    }
}

fn captured_frame_path(app: &#x26;App, frame: &#x26;Frame) -> std::path::PathBuf {
    app.project_path()
        .expect("failed to locate `project_path`")
        .join("frames")
        .join(format!("{:04}", frame.nth()))
        .with_extension("png")
}
</code></pre>
</div></article></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"2021-08-14","contentHtml":"\u003cvideo autoplay loop controls\u003e\n  \u003csource src=\"/assets/2021-08/perlin-circles.mp4\" type=\"video/mp4\"\u003e\n\u003c/video\u003e\n\u003cp\u003e\u003ca href=\"https://nannou.cc/\"\u003eNannou\u003c/a\u003e code:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003euse nannou::noise::*;\nuse nannou::prelude::*;\n\nfn main() {\n    nannou::app(model).run();\n}\n\nstruct Model {\n    cols: u32,\n    rows: u32,\n    noise: Perlin,\n}\n\nfn model(app: \u0026#x26;App) -\u003e Model {\n    let width = 200;\n    let height = 200;\n    let scale = 10;\n    app.new_window().size(width, height).view(view).build().unwrap();\n    let cols = width / scale;\n    let rows = height / scale;\n    let mut noise = Perlin::new();\n    noise = noise.set_seed(1);\n\n    Model {\n        cols,\n        rows,\n        noise\n    }\n}\n\nfn view(app: \u0026#x26;App, model: \u0026#x26;Model, frame: Frame) {\n    frame.clear(BLACK);\n    let win = app.main_window();\n    let win_r = win.rect();\n\n    let draw = app.draw();\n    let mut yoff = 0.0;\n    let zoff = app.time / 5.0;\n    let cell_size = (win_r.right() - win_r.left()) / model.cols as f32;\n\n    for col in 0..model.cols {\n        let mut xoff = 0.0;\n        for row in 0..model.rows {\n            let random = model.noise.get([xoff as f64, yoff as f64, zoff as f64]);\n            let start_x = map_range(col as f32, 0.0, model.cols as f32, win_r.left(), win_r.right());\n            let start_y = map_range(row as f32, 0.0, model.rows as f32, win_r.bottom(), win_r.top());\n            let size = random as f32 * cell_size;\n\n            draw.ellipse()\n                .width(size)\n                .height(size)\n                .x_y(start_x, start_y)\n                .color(hsl(random as f32, 1.0, 0.5));\n\n                xoff += 0.1;\n        }\n\n        yoff += 0.1;\n    }\n\n    draw.to_frame(app, \u0026#x26;frame).unwrap();\n    \n    if frame.nth() \u0026#x3C; 300 {\n        let file_path = captured_frame_path(app, \u0026#x26;frame);\n        app.main_window().capture_frame(file_path);\n    }\n}\n\nfn captured_frame_path(app: \u0026#x26;App, frame: \u0026#x26;Frame) -\u003e std::path::PathBuf {\n    app.project_path()\n        .expect(\"failed to locate `project_path`\")\n        .join(\"frames\")\n        .join(format!(\"{:04}\", frame.nth()))\n        .with_extension(\"png\")\n}\n\u003c/code\u003e\u003c/pre\u003e\n","title":"Code Sketch - Perlin Circles","date":"2021-08-14"}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"2021-08-14"},"buildId":"OJKJPB7h_rkE15QK9wh6b","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>